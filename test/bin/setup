#!/bin/sh

set -e
set -u
set -o pipefail

mkdir -p test/fixtures

for fixture in test/data/*.dot
do
  dot=$(basename $fixture)
  adj=test/fixtures/${dot//.dot/.adj}

  # add a dummy weight of 1 to each line. TODO weighted rank
  bin/dot-to-tsv < $fixture | sed 's/$/	1/' | adj=$adj bin/pipeline > $adj

  # add headers
  cat $adj.meta $adj > $adj.tmp
  mv $adj.tmp $adj
  rm $adj.meta
done

